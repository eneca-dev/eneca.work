# –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π eneca.work

## üìã –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –≤ eneca.work –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–æ—Å—Ç—É–ø–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–µ–¥–Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤.

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```sql
-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
roles: id, name, description
permissions: id, name, description  
role_permissions: role_id, permission_id
user_roles: user_id, role_id

-- –°–≤—è–∑–∏
user ‚Üí user_roles ‚Üí roles ‚Üí role_permissions ‚Üí permissions
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (6 –º–æ–¥—É–ª–µ–π)

| –ú–æ–¥—É–ª—å | –†–∞–∑—Ä–µ—à–µ–Ω–∏–π | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|-----------|------------|
| **hierarchy** | 5 | –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è –∞–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ |
| **users** | 7 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å |
| **calendar** | 5 | –ö–∞–ª–µ–Ω–¥–∞—Ä—å, —Å–æ–±—ã—Ç–∏—è, —Ä–∞–±–æ—á–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ |
| **projects** | 4 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –∏ –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π |
| **planning** | 3 | –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–æ–∫ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤ |
| **announcements** | 3 | –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏ |

### –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã (hierarchy.*)

–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–µ–¥–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤:

| –°—Ç–∞—Ç—É—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ |
|--------|------------|-----------------|
| `hierarchy.is_admin` | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º |
| `hierarchy.is_department_head` | –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ | –î–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ —Å–≤–æ–µ–≥–æ –æ—Ç–¥–µ–ª–∞ |
| `hierarchy.is_project_manager` | –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ | –¢–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø—Ä–æ–µ–∫—Ç—ã |
| `hierarchy.is_team_lead` | –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –∫–æ–º–∞–Ω–¥—ã | –î–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥—ã |
| `hierarchy.is_user` | –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ |

## üë• –†–æ–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ

| –†–æ–ª—å | –†–∞–∑—Ä–µ—à–µ–Ω–∏–π | Hierarchy —Å—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------------|------------------|----------|
| **admin** | 25 | `hierarchy.is_admin` | –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ —Å–∏—Å—Ç–µ–º—ã |
| **department_head** | 14 | `hierarchy.is_department_head` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–æ–º |
| **project_manager** | 11 | `hierarchy.is_project_manager` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ |
| **team_lead** | 9 | `hierarchy.is_team_lead` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π |
| **user** | 8 | `hierarchy.is_user` | –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∞ |

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### 1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π
```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Ä–æ–ª—å
INSERT INTO user_roles (user_id, role_id) 
VALUES ('user-uuid', 'role-uuid')
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
```typescript
// –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const permissions = await getUserPermissions(userId)
// –†–µ–∑—É–ª—å—Ç–∞—Ç: ['users.view.all', 'hierarchy.is_team_lead', ...]
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞
```typescript
// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
const { hasPermission } = usePermissions()

if (hasPermission('users.admin_panel')) {
  // –ü–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
}
```

### 4. –ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
```typescript
// –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã
if (hasPermission('hierarchy.is_team_lead')) {
  setTeamFilter(userTeam)      // –¢–æ–ª—å–∫–æ –º–æ—è –∫–æ–º–∞–Ω–¥–∞
  setTeamLocked(true)          // –ù–µ–ª—å–∑—è —Å–º–µ–Ω–∏—Ç—å
}
```

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

### –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–º–µ–µ—Ç —Å–≤–æ–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- –§–æ—Ä–º–∞—Ç: `–º–æ–¥—É–ª—å.–¥–µ–π—Å—Ç–≤–∏–µ.–æ–±—ä–µ–∫—Ç` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `users.edit.all`)
- –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –Ω–æ–≤—ã–º–∏ –º–æ–¥—É–ª—è–º–∏

### –ò–µ—Ä–∞—Ä—Ö–∏—á–Ω–æ—Å—Ç—å  
- Hierarchy —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç —Ñ–∏–ª—å—Ç—Ä—ã
- –ö–∞–∂–¥–∞—è —Ä–æ–ª—å –∏–º–µ–µ—Ç –æ–¥–∏–Ω hierarchy —Å—Ç–∞—Ç—É—Å

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ (admin, user) –Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –∏ –±—ç–∫–µ–Ω–¥–µ
- –°–∏—Å—Ç–µ–º–∞ "–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–ø—Ä–µ—â–µ–Ω–æ"

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è permissions

```
modules/permissions/
‚îú‚îÄ‚îÄ components/          # Guard –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ constants/          # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∏ —Ä–æ–ª–µ–π
‚îú‚îÄ‚îÄ hooks/             # React —Ö—É–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤
‚îú‚îÄ‚îÄ store/             # Zustand —Å—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îú‚îÄ‚îÄ supabase/          # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase
‚îú‚îÄ‚îÄ types/             # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ utils/             # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–∞–≤–∞–º–∏
‚îî‚îÄ‚îÄ index.ts           # –ü—É–±–ª–∏—á–Ω—ã–π API –º–æ–¥—É–ª—è
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

–ü–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–æ–¥—É–ª—è permissions —Å–º. –≤:
**`modules/permissions/README.md`**

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

### –° legacy —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ legacy —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è 
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ –Ω–æ–≤—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- ‚úÖ –ê–¥–º–∏–Ω —Å–æ—Ö—Ä–∞–Ω–∏–ª –≤—Å–µ –ø—Ä–∞–≤–∞ (25 —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –ø–æ—Ç–µ—Ä—è–ª–∏ –¥–æ—Å—Ç—É–ø—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
```sql
-- 1. –°–æ–∑–¥–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
INSERT INTO permissions (name, description) 
VALUES ('module.action.target', '–û–ø–∏—Å–∞–Ω–∏–µ');

-- 2. –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª—è–º
INSERT INTO role_permissions (role_id, permission_id)
SELECT role_id, permission_id FROM ...;
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

- **25 —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π** –≤ 6 –º–æ–¥—É–ª—è—Ö
- **5 —Ä–æ–ª–µ–π** —Å —á–µ—Ç–∫–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–µ–π  
- **5 hierarchy —Å—Ç–∞—Ç—É—Å–æ–≤** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
- **0 legacy —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π** (–ø–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞)

---

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –º–æ–¥—É–ª—å–Ω–∞—è, –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é!** üéâ 