# üîê –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –≤–∫–ª—é—á–∞–µ—Ç –¥–≤–∞ —É—Ä–æ–≤–Ω—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è** ‚Äî —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö** ‚Äî –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å

## üóÑÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- `roles` ‚Äî —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (admin, user, project_manager)
- `permissions` ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (user_admin_panel_can_view)
- `role_permissions` ‚Äî —Å–≤—è–∑–∫–∞ –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º –º–µ–∂–¥—É —Ä–æ–ª—è–º–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- `profiles` ‚Äî –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–ª–µ–º `role_id`

### –°–≤—è–∑–∏
```
User (auth.users) ‚Üí Profile ‚Üí Role ‚Üí Role_Permissions ‚Üí Permissions
```

## üé≠ –¢–µ–∫—É—â–∏–µ —Ä–æ–ª–∏

### Admin (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
- –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª—è–º–∏
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ü—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ –ª—é–±—ã—Ö —Ä–æ–ª–µ–π

### User (–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

## üõ°Ô∏è –¢–µ–∫—É—â–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

| –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|
| `user_admin_panel_can_view` | –î–æ—Å—Ç—É–ø –∫ –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `users_can_edit_all` | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `roles_can_add` | –ü—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ —Ä–æ–ª–µ–π (–∫—Ä–æ–º–µ admin) |
| `admin_role_can_add` | –ü—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `announcements_can_create_and_edit` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏ |
| `calendar_can_create_and_edit_global_events` | –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è |

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

1. **DashboardLayout** –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∞–≤
2. **getUserRoleAndPermissions()** –ø–æ–ª—É—á–∞–µ—Ç —Ä–æ–ª—å –∏–∑ `profiles` –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–≤—è–∑–∫–∏
3. **useUserStore** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏ (–Ω–µ –≤ localStorage)
4. Retry –ª–æ–≥–∏–∫–∞ —Å 3 –ø–æ–ø—ã—Ç–∫–∞–º–∏ –∏ exponential backoff
5. Fallback timeout 5 —Å–µ–∫—É–Ω–¥

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
```typescript
// –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
const canEdit = permissions.includes("users_can_edit_all")

// –ß–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ store
const canCreate = userStore.hasPermission("announcements_can_create_and_edit")

// –ß–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—É–∫
const { canViewAdminPanel } = useAdminPermissions()
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-–≥–∞—Ä–¥—ã
- `AdminAccessCheck` ‚Äî –∑–∞—â–∏—Ç–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- `PaymentAccessCheck` ‚Äî –∑–∞—â–∏—Ç–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

## üöÄ –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

**–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `projects.*` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤
- `users.*` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
- `planning.*` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `calendar.*` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è

**–ò–µ—Ä–∞—Ä—Ö–∏—è –¥–µ–π—Å—Ç–≤–∏–π:**
- `.view.all` / `.view.department` / `.view.team`
- `.edit.all` / `.edit.managed` / `.edit.own`
- `.create` / `.delete` / `.admin`

### 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (Data Constraints)

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–µ —Ç–æ–ª—å–∫–æ –ß–¢–û –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å, –Ω–æ –∏ –° –ö–ê–ö–ò–ú–ò –î–ê–ù–ù–´–ú–ò

**–¢–∏–ø—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π:**
- `projects.scope.all` ‚Äî –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã
- `projects.scope.managed` ‚Äî —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
- `departments.scope.own` ‚Äî —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –æ—Ç–¥–µ–ª
- `users.scope.team` ‚Äî —Ç–æ–ª—å–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã

### 3. –£–º–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏:**
- **–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞:** –æ—Ç–¥–µ–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Å–≤–æ–µ–º, –º–æ–∂–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- **–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:** –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:** –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã

**UX –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–º–µ—á–µ–Ω—ã –∏–∫–æ–Ω–∫–æ–π –∑–∞–º–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ö–∞—Å–∫–∞–¥–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

### 4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —É—Å–ª–æ–≤–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞

**PermissionGuard** ‚Äî –ø–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å fallback
**PermissionBoundary** ‚Äî –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Å–∫–µ–ª–µ—Ç–æ–Ω–∞–º–∏

## üë• –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ä–æ–ª–∏

### Project Manager (–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∞–º–∏ –∫–æ–º–∞–Ω–¥—ã
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã

### Department Head (–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ –æ—Ç–¥–µ–ª–∞
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –æ—Ç–¥–µ–ª

### Team Lead (–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –∫–æ–º–∞–Ω–¥—ã)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ –∫–æ–º–∞–Ω–¥—ã
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —É—á–∞—Å—Ç–∏–µ–º –∫–æ–º–∞–Ω–¥—ã
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–æ–∫ –∫–æ–º–∞–Ω–¥—ã
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ —Å–≤–æ—è –∫–æ–º–∞–Ω–¥–∞

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **Zustand store** —Å persist middleware (–∫—Ä–æ–º–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π)
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞** –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–æ–ª–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Lazy loading –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ó–∞—â–∏—Ç–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–æ–ª–µ–π –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è
- Race condition protection
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ API

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã

1. **–ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å** ‚Äî —Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
2. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** ‚Äî –ª–µ–≥–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞
4. **UX** ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
6. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äî –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–æ—Å—Ç—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

## üß© –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

```
permissions/
‚îú‚îÄ‚îÄ hooks/              # –•—É–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
‚îú‚îÄ‚îÄ components/         # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞—â–∏—Ç—ã –∏ —É—Å–ª–æ–≤–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞
‚îú‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã –∏ —Ö–µ–ª–ø–µ—Ä—ã
‚îú‚îÄ‚îÄ types/              # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ constants/          # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
‚îú‚îÄ‚îÄ store/              # Zustand store —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
‚îî‚îÄ‚îÄ supabase/           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase
```

### üé£ –•—É–∫–∏ (Hooks)

**`usePermissions()`** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ö—É–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- `hasPermission(permission)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- `hasAnyPermission(permissions[])` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª—é–±–æ–≥–æ –∏–∑ —Å–ø–∏—Å–∫–∞
- `hasAllPermissions(permissions[])` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∏–∑ —Å–ø–∏—Å–∫–∞
- `getPermissionLevel(module)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–æ–¥—É–ª—é

**`useDataConstraints()`** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö
- `getAvailableProjects()` ‚Äî –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `getAvailableDepartments()` ‚Äî –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Ç–¥–µ–ª—ã
- `getAvailableTeams()` ‚Äî –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `isDataLocked(dataType)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**`useModulePermissions(moduleName)`** ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
- `useProjectsPermissions()` ‚Üí `{ canView, canEdit, canCreate, canDelete }`
- `useUsersPermissions()` ‚Üí `{ canViewAll, canEditAll, canManage }`
- `usePlanningPermissions()` ‚Üí `{ canViewLoadings, canEditPlan }`

### üõ°Ô∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞—â–∏—Ç—ã

**`<PermissionGuard>`** ‚Äî —É—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- `permission: string` ‚Äî —Ç—Ä–µ–±—É–µ–º–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
- `fallback?: ReactNode` ‚Äî —á—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–∞–≤
- `children: ReactNode` ‚Äî –∑–∞—â–∏—â–∞–µ–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç

**`<PermissionBoundary>`** ‚Äî –æ–±–µ—Ä—Ç–∫–∞ —Å –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–æ–π
- `children: ReactNode` ‚Äî –∫–æ–Ω—Ç–µ–Ω—Ç
- `loading?: ReactNode` ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ (—Å–∫–µ–ª–µ—Ç–æ–Ω)

**`<RoleGuard>`** ‚Äî –∑–∞—â–∏—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ä–æ–ª–µ–π
- `allowedRoles: string[]` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏
- `redirectTo?: string` ‚Äî –∫—É–¥–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ

**`<DataScopeProvider>`** ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö
- `scope: DataScope` ‚Äî —Ç–µ–∫—É—â–∞—è –æ–±–ª–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- `children: ReactNode`

### üîß –£—Ç–∏–ª–∏—Ç—ã

**`permissionUtils.ts`** ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `checkPermission(user, permission)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- `getUserDataScope(user)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `mergePermissions(permissions[])` ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- `validatePermissionStructure(permission)` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**`roleUtils.ts`** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ä–æ–ª—è–º–∏
- `getRolePermissions(roleId)` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ä–æ–ª–∏
- `getUserRoles(userId)` ‚Äî —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `isSystemRole(roleName)` ‚Äî —Å–∏—Å—Ç–µ–º–Ω–∞—è –ª–∏ —Ä–æ–ª—å
- `canAssignRole(currentUser, targetRole)` ‚Äî –º–æ–∂–µ—Ç –ª–∏ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª—å

### üìä –¢–∏–ø—ã –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

**`types/permissions.ts`** ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã
```typescript
interface Permission {
  id: string
  name: string
  module: string
  action: string
  scope?: string
}

interface DataConstraint {
  type: 'scope' | 'filter' | 'access'
  target: string
  restriction: string
}
```

**`constants/permissions.ts`** ‚Äî –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
```typescript
export const PERMISSIONS = {
  PROJECTS: {
    VIEW_ALL: 'projects.view.all',
    EDIT_MANAGED: 'projects.edit.managed'
  },
  USERS: {
    VIEW_ALL: 'users.view.all',
    EDIT_ALL: 'users.edit.all'
  }
}
```

**`constants/roles.ts`** ‚Äî —Ä–æ–ª–∏ –∏ –∏—Ö –Ω–∞–±–æ—Ä—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
```typescript
export const ROLE_TEMPLATES = {
  ADMIN: [...],
  PROJECT_MANAGER: [...],
  DEPARTMENT_HEAD: [...]
}
```

### üíæ –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**`usePermissionsStore.ts`** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- `permissions: string[]` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `constraints: DataConstraint[]` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- `isLoading: boolean` ‚Äî —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
- `loadPermissions(userId)` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- `hasPermission(permission)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

**`useDataScopeStore.ts`** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç—è–º–∏ –¥–∞–Ω–Ω—ã—Ö
- `availableProjects: Project[]`
- `availableDepartments: Department[]`
- `availableTeams: Team[]`
- `lockedFilters: string[]`

### üóÑÔ∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase

**`supabasePermissions.ts`** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ Supabase
- `getUserPermissions(userId)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `getRolePermissions(roleId)` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ä–æ–ª–∏
- `updateUserRole(userId, roleId)` ‚Äî —Å–º–µ–Ω–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `getDataConstraints(userId)` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

**`supabaseQueries.ts`** ‚Äî SQL –∑–∞–ø—Ä–æ—Å—ã –∏ RPC —Ñ—É–Ω–∫—Ü–∏–∏
- `getUserRoleAndPermissions()` ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Ä–æ–ª–∏ –∏ –ø—Ä–∞–≤
- `checkUserPermission()` ‚Äî RPC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- `getConstrainedData()` ‚Äî –¥–∞–Ω–Ω—ã–µ —Å —É—á–µ—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

**`supabaseSync.ts`** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `syncPermissionsFromSupabase()` ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- `subscribeToPermissionChanges()` ‚Äî real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `handlePermissionUpdate()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### üîÑ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
usePermissionsStore ‚Üí usePermissions ‚Üí PermissionGuard ‚Üí UI Components
                   ‚Üì
useDataConstraints ‚Üí DataScopeProvider ‚Üí Feature Modules
                   ‚Üì
supabasePermissions ‚Üí supabaseSync ‚Üí Real-time Updates
```
