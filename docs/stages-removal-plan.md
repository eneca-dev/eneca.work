# –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏: –û—Ç–∫–∞–∑ –æ—Ç —É—Ä–æ–≤–Ω—è "–°—Ç–∞–¥–∏—è"

## –¶–µ–ª—å

–£–±—Ä–∞—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å `stages` –∏–∑ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∏ —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞–¥–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –ø—Ä–æ–µ–∫—Ç–∞ (`stage_type`).

**–¢–µ–∫—É—â–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è:**
```
–ü—Ä–æ–µ–∫—Ç (projects)
  ‚îî‚îÄ –°—Ç–∞–¥–∏—è (stages)        ‚Üê –£–ë–ò–†–ê–ï–ú
      ‚îî‚îÄ –û–±—ä–µ–∫—Ç (objects)
          ‚îî‚îÄ –†–∞–∑–¥–µ–ª (sections)
              ‚îî‚îÄ –≠—Ç–∞–ø –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ (decomposition_stages)
```

**–ù–æ–≤–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è:**
```
–ü—Ä–æ–µ–∫—Ç (projects) + stage_type: text
  ‚îî‚îÄ –û–±—ä–µ–∫—Ç (objects)
      ‚îî‚îÄ –†–∞–∑–¥–µ–ª (sections)
          ‚îî‚îÄ –≠—Ç–∞–ø –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ (decomposition_stages)
```

**–í–º–µ—Å—Ç–æ:**
- 1 –ø—Ä–æ–µ–∫—Ç "–°–∫–ª–∞–¥" ‚Üí 2 —Å—Ç–∞–¥–∏–∏ (–ê, –°) ‚Üí –æ–±—ä–µ–∫—Ç—ã –≤ –∫–∞–∂–¥–æ–π

**–ë—É–¥–µ—Ç:**
- –ü—Ä–æ–µ–∫—Ç "–°–∫–ª–∞–¥ ‚Äî –°—Ç–∞–¥–∏—è –ê" ‚Üí –æ–±—ä–µ–∫—Ç—ã
- –ü—Ä–æ–µ–∫—Ç "–°–∫–ª–∞–¥ ‚Äî –°—Ç–∞–¥–∏—è –°" ‚Üí –æ–±—ä–µ–∫—Ç—ã

---

## –û–±–ª–∞—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ú–æ–¥—É–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï —Ç—Ä–æ–≥–∞–µ–º

| –ú–æ–¥—É–ª—å | –ü—Ä–∏—á–∏–Ω–∞ |
|--------|---------|
| `modules/projects/` | –û—Ç–ª–æ–∂–µ–Ω–æ –Ω–∞ –ø–æ—Ç–æ–º |
| `modules/planning/` | –û—Ç–ª–æ–∂–µ–Ω–æ –Ω–∞ –ø–æ—Ç–æ–º |
| `modules/modals/` | –†–∞–±–æ—Ç–∞–µ—Ç —Å `decomposition_stages` (—ç—Ç–∞–ø—ã –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ä–∞–∑–¥–µ–ª–∞) ‚Äî —ç—Ç–æ –¥—Ä—É–≥–∞—è —Å—É—â–Ω–æ—Å—Ç—å |
| `modules/decomposition/` | –¢–æ –∂–µ —Å–∞–º–æ–µ |
| `modules/decomposition2/` | –¢–æ –∂–µ —Å–∞–º–æ–µ |
| `modules/dec-templates/` | –®–∞–±–ª–æ–Ω—ã –¥–ª—è decomposition_stages |

### –ú–æ–¥—É–ª–∏ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏

| –ú–æ–¥—É–ª—å | –§–∞–π–ª–æ–≤ | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|--------|--------|-----------|
| cache | 1 | –°—Ä–µ–¥–Ω—è—è |
| dashboard | 3 | –õ—ë–≥–∫–∞—è |
| reports | 2 | –°—Ä–µ–¥–Ω—è—è |
| task-transfer | 5 | –°—Ä–µ–¥–Ω—è—è |
| resource-graph | 8 | –í—ã—Å–æ–∫–∞—è |
| budgets | 2 | –°—Ä–µ–¥–Ω—è—è |
| project-reports | 2 | –°—Ä–µ–¥–Ω—è—è |
| kanban | 5 | –°—Ä–µ–¥–Ω—è—è |

**–í—Å–µ–≥–æ: ~28 —Ñ–∞–π–ª–æ–≤**

---

## –§–∞–∑—ã –º–∏–≥—Ä–∞—Ü–∏–∏

### –§–∞–∑–∞ 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ë–î

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö (dual-write –ø–µ—Ä–∏–æ–¥).

**–°—Ç–∞—Ç—É—Å:** [x] –í—ã–ø–æ–ª–Ω–µ–Ω–æ (2025-12-30)

**–ü—Ä–∏–º–µ–Ω—ë–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è:** `add_stage_type_and_object_project_id`

```sql
-- 1. –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ stage_type –≤ projects
ALTER TABLE projects ADD COLUMN IF NOT EXISTS stage_type text;

-- 2. –î–æ–±–∞–≤–ª—è–µ–º object_project_id –≤ objects
ALTER TABLE objects ADD COLUMN IF NOT EXISTS object_project_id uuid REFERENCES projects(project_id);

-- 3. –î–æ–±–∞–≤–ª—è–µ–º project_id –≤ project_reports
ALTER TABLE project_reports ADD COLUMN IF NOT EXISTS project_id uuid REFERENCES projects(project_id);

-- 4. –ó–∞–ø–æ–ª–Ω—è–µ–º stage_type –∏–∑ –ø–µ—Ä–≤–æ–π —Å—Ç–∞–¥–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
UPDATE projects p SET stage_type = (
  SELECT s.stage_name FROM stages s
  WHERE s.stage_project_id = p.project_id
  ORDER BY s.stage_created LIMIT 1
) WHERE p.stage_type IS NULL;

-- 5. –ó–∞–ø–æ–ª–Ω—è–µ–º object_project_id —á–µ—Ä–µ–∑ stages
UPDATE objects o SET object_project_id = (
  SELECT s.stage_project_id FROM stages s
  WHERE s.stage_id = o.object_stage_id
) WHERE o.object_project_id IS NULL AND o.object_stage_id IS NOT NULL;

-- 6. –ó–∞–ø–æ–ª–Ω—è–µ–º project_id –≤ project_reports —á–µ—Ä–µ–∑ stages
UPDATE project_reports pr SET project_id = (
  SELECT s.stage_project_id FROM stages s
  WHERE s.stage_id = pr.stage_id
) WHERE pr.project_id IS NULL AND pr.stage_id IS NOT NULL;

-- 7. –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX IF NOT EXISTS idx_objects_object_project_id ON objects(object_project_id);
CREATE INDEX IF NOT EXISTS idx_project_reports_project_id ON project_reports(project_id);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏:**

| –¢–∞–±–ª–∏—Ü–∞ | –ó–∞–ø–æ–ª–Ω–µ–Ω–æ | –ü—É—Å—Ç–æ | –í—Å–µ–≥–æ |
|---------|-----------|-------|-------|
| `projects.stage_type` | 76 | 1 | 77 |
| `objects.object_project_id` | 276 | 2 | 278 |
| `project_reports.project_id` | 8 | 0 | 8 |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
- 1 –ø—Ä–æ–µ–∫—Ç –±–µ–∑ —Å—Ç–∞–¥–∏–π (stage_type = NULL) ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- 2 –æ–±—ä–µ–∫—Ç–∞ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ ‚Äî orphaned –∑–∞–ø–∏—Å–∏ –±–µ–∑ object_stage_id

**`npm run db:types`:** –í—ã–ø–æ–ª–Ω–µ–Ω, —Ç–∏–ø—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã

---

### –§–∞–∑–∞ 1: –ú–æ–¥—É–ª—å `cache`

**–¶–µ–ª—å:** –û–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ stages.

**–§–∞–π–ª—ã:**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `modules/cache/actions/projects.ts` | –£–±—Ä–∞—Ç—å `stage_id` –∏–∑ —Ç–∏–ø–æ–≤. –û–±—ä–µ–∫—Ç—ã –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å –∫ `project_id` –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `object_project_id` |

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
```typescript
// –°—Ç—Ä–æ–∏—Ç: project ‚Üí stages ‚Üí objects ‚Üí sections
stagesMap.set(row.stage_id, {...})
stagesMap.get(row.stage_id)!.objects.push(objectNode)
```

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
```typescript
// –°—Ç—Ä–æ–∏—Ç: project (+ stage_type) ‚Üí objects ‚Üí sections
// –û–±—ä–µ–∫—Ç—ã –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥ –ø—Ä–æ–µ–∫—Ç–æ–º
project.objects.push(objectNode)
```

**–°—Ç–∞—Ç—É—Å:** [ ] –ù–µ –Ω–∞—á–∞—Ç–æ

---

### –§–∞–∑–∞ 2: –ú–æ–¥—É–ª—å `dashboard`

**–¶–µ–ª—å:** –£–±—Ä–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –ø–æ–¥—Å—á—ë—Ç —Å—Ç–∞–¥–∏–π.

**–§–∞–π–ª—ã:**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `components/cards/ProjectInfoCard.tsx` | –£–±—Ä–∞—Ç—å –ø–æ–¥—Å—á—ë—Ç —Å—Ç–∞–¥–∏–π (`COUNT stages`). –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å `stage_type` –∫–∞–∫ –∞—Ç—Ä–∏–±—É—Ç –ø—Ä–æ–µ–∫—Ç–∞ |
| `components/cards/LastActivityCard.tsx` | –£–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ `stage_id`. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `object_project_id` |
| `hooks/useProjectStatistics.ts` | –£–±—Ä–∞—Ç—å –∑–∞–ø—Ä–æ—Å `stages.select('stage_id')`. –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥—É—é –º–µ—Ç—Ä–∏–∫—É –∏–ª–∏ —É–±—Ä–∞—Ç—å |

**UI –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í–º–µ—Å—Ç–æ "–°—Ç–∞–¥–∏–π: 2" –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å badge —Å `stage_type` (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–°—Ç–∞–¥–∏—è –°")
- –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ —É–±—Ä–∞—Ç—å —ç—Ç–æ—Ç —Å—á—ë—Ç—á–∏–∫

**–°—Ç–∞—Ç—É—Å:** [ ] –ù–µ –Ω–∞—á–∞—Ç–æ

---

### –§–∞–∑–∞ 3: –ú–æ–¥—É–ª—å `reports`

**–¶–µ–ª—å:** –£–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞–¥–∏—è–º.

**–§–∞–π–ª—ã:**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `ReportsPage.tsx` | –£–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ `stage_id` –∏–∑ –∑–∞–ø—Ä–æ—Å–∞. View —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `stage_name` ‚Äî –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `stage_type` –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ |
| `filters/projectStore.ts` | –£–±—Ä–∞—Ç—å –∫–∞—Å–∫–∞–¥–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É `stages ‚Üí objects`. –ó–∞–≥—Ä—É–∂–∞—Ç—å objects –Ω–∞–ø—Ä—è–º—É—é –ø–æ `project_id` —á–µ—Ä–µ–∑ `object_project_id` |

**–¢–µ–∫—É—â–∏–π –∫–∞—Å–∫–∞–¥ —Ñ–∏–ª—å—Ç—Ä–æ–≤:**
```
–ü—Ä–æ–µ–∫—Ç ‚Üí –°—Ç–∞–¥–∏—è ‚Üí –û–±—ä–µ–∫—Ç ‚Üí –†–∞–∑–¥–µ–ª
```

**–ù–æ–≤—ã–π –∫–∞—Å–∫–∞–¥:**
```
–ü—Ä–æ–µ–∫—Ç (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º stage_type) ‚Üí –û–±—ä–µ–∫—Ç ‚Üí –†–∞–∑–¥–µ–ª
```

**–°—Ç–∞—Ç—É—Å:** [ ] –ù–µ –Ω–∞—á–∞—Ç–æ

---

### –§–∞–∑–∞ 4: –ú–æ–¥—É–ª—å `task-transfer`

**–¶–µ–ª—å:** –£–±—Ä–∞—Ç—å stages –∏–∑ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤.

**–§–∞–π–ª—ã:**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `types.ts` | –£–±—Ä–∞—Ç—å `stage_id: string \| null` –∏–∑ —Ç–∏–ø–æ–≤ |
| `store.ts` | –£–±—Ä–∞—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ `stagesMap`. –û–±—ä–µ–∫—Ç—ã –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ `project_id` |
| `utils.ts` | –£–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ `stageId` |
| `filters/store.ts` | –£–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä stages –∏–∑ –∫–∞—Å–∫–∞–¥–∞ |
| `filters/configs.ts` | –£–±—Ä–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ñ–∏–ª—å—Ç—Ä–∞ stages |
| `filters/TaskTransferFilters.tsx` | –£–±—Ä–∞—Ç—å UI —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —Å—Ç–∞–¥–∏–π |

**–ò–µ—Ä–∞—Ä—Ö–∏—è UI —Å–µ–π—á–∞—Å:**
```
–ü—Ä–æ–µ–∫—Ç ‚Üí –°—Ç–∞–¥–∏—è ‚Üí –û–±—ä–µ–∫—Ç ‚Üí –†–∞–∑–¥–µ–ª
```

**–ò–µ—Ä–∞—Ä—Ö–∏—è UI –ø–æ—Å–ª–µ:**
```
–ü—Ä–æ–µ–∫—Ç (+ stage_type badge) ‚Üí –û–±—ä–µ–∫—Ç ‚Üí –†–∞–∑–¥–µ–ª
```

**–°—Ç–∞—Ç—É—Å:** [ ] –ù–µ –Ω–∞—á–∞—Ç–æ

---

### –§–∞–∑–∞ 5: –ú–æ–¥—É–ª—å `resource-graph`

**–¶–µ–ª—å:** –£–ø—Ä–æ—Å—Ç–∏—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é –¥–µ—Ä–µ–≤–∞ ‚Äî —É–±—Ä–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞–¥–∏–π.

**–≠—Ç–æ —Å–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π –º–æ–¥—É–ª—å!**

**–§–∞–π–ª—ã:**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `actions/index.ts` | –£–±—Ä–∞—Ç—å `stagesMap`. –û–±—ä–µ–∫—Ç—ã —Å—Ç—Ä–æ–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥ –ø—Ä–æ–µ–∫—Ç–æ–º |
| `utils/index.ts` | –ò–∑–º–µ–Ω–∏—Ç—å `buildHierarchy` ‚Äî —É–±—Ä–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å stages |
| `utils/hierarchy.ts` | –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ |
| `types/index.ts` | –£–±—Ä–∞—Ç—å `StageRow` –∏–∑ —Ç–∏–ø–æ–≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏ |
| `stores/index.ts` | –£–±—Ä–∞—Ç—å stages –∏–∑ state |
| `components/ResourceGraph.tsx` | –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–µ—Ä–µ–≤–∞ |
| `components/timeline/rows/StageRow.tsx` | **–£–î–ê–õ–ò–¢–¨** —Ñ–∞–π–ª |
| `components/timeline/rows/ProjectRow.tsx` | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å `stage_type` –∫–∞–∫ badge |
| `components/timeline/rows/index.ts` | –£–±—Ä–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç StageRow |

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞:**
```
üìÅ –ü—Ä–æ–µ–∫—Ç
  ‚îî‚îÄ üìÇ –°—Ç–∞–¥–∏—è –ê      ‚Üê –£–ë–ò–†–ê–ï–ú
      ‚îî‚îÄ üìÇ –û–±—ä–µ–∫—Ç
          ‚îî‚îÄ üìÑ –†–∞–∑–¥–µ–ª
              ‚îî‚îÄ üìã –≠—Ç–∞–ø –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
```

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
üìÅ –ü—Ä–æ–µ–∫—Ç [–°—Ç–∞–¥–∏—è –ê]   ‚Üê stage_type –∫–∞–∫ badge
  ‚îî‚îÄ üìÇ –û–±—ä–µ–∫—Ç
      ‚îî‚îÄ üìÑ –†–∞–∑–¥–µ–ª
          ‚îî‚îÄ üìã –≠—Ç–∞–ø –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
```

**–°—Ç–∞—Ç—É—Å:** [ ] –ù–µ –Ω–∞—á–∞—Ç–æ

---

### –§–∞–∑–∞ 6: –ú–æ–¥—É–ª—å `budgets`

**–¶–µ–ª—å:** –û–±–Ω–æ–≤–∏—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é –±—é–¥–∂–µ—Ç–æ–≤.

**–§–∞–π–ª—ã:**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `actions/budget-actions.ts` | –ò–∑–º–µ–Ω–∏—Ç—å `getEntityHierarchy` ‚Äî —É–±—Ä–∞—Ç—å `stageId` –∏–∑ —Ü–µ–ø–æ—á–∫–∏. –ü–æ–ª—É—á–∞—Ç—å `projectId` –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `object_project_id` |
| `types.ts` | –£–±—Ä–∞—Ç—å `stageId` –∏–∑ `EntityHierarchy` |

**–¢–µ–∫—É—â–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –±—é–¥–∂–µ—Ç–æ–≤:**
```typescript
interface EntityHierarchy {
  projectId: string
  stageId: string      // ‚Üê –£–ë–ò–†–ê–ï–ú
  objectId: string
  sectionId: string
}
```

**–ù–æ–≤–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è:**
```typescript
interface EntityHierarchy {
  projectId: string
  stageType?: string   // ‚Üê –î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  objectId: string
  sectionId: string
}
```

**–°—Ç–∞—Ç—É—Å:** [ ] –ù–µ –Ω–∞—á–∞—Ç–æ

---

### –§–∞–∑–∞ 7: –ú–æ–¥—É–ª—å `project-reports`

**–¶–µ–ª—å:** –ü—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å –æ—Ç—á—ë—Ç—ã –∫ –ø—Ä–æ–µ–∫—Ç—É –≤–º–µ—Å—Ç–æ —Å—Ç–∞–¥–∏–∏.

**–§–∞–π–ª—ã:**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `actions/index.ts` | ‚úÖ –£–±—Ä–∞–Ω `stage_id`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `project_id` |
| `types/index.ts` | ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ `stageId` –Ω–∞ `projectId` |
| `hooks/index.ts` | ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã —Ö—É–∫–∏ |
| `components/ProjectReportsRow.tsx` | ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã props |
| `modules/modals/.../ProjectReportModal.tsx` | ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã props |
| `modules/resource-graph/.../ProjectRow.tsx` | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω ProjectReportsRow |
| `modules/resource-graph/.../StageRow.tsx` | ‚úÖ –£–±—Ä–∞–Ω ProjectReportsRow |

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:** –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é –ë–î –∏–∑ –§–∞–∑—ã 0 (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `project_id` –≤ —Ç–∞–±–ª–∏—Ü—É `project_reports`).

**–°—Ç–∞—Ç—É—Å:** [x] –í—ã–ø–æ–ª–Ω–µ–Ω–æ (2025-12-30)

**–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** Alias'—ã –≤ index.ts (useStageReports ‚Üí useProjectReports)

---

### –§–∞–∑–∞ 8: –ú–æ–¥—É–ª—å `kanban`

**–¶–µ–ª—å:** –£–±—Ä–∞—Ç—å stages –∏–∑ –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π.

**–§–∞–π–ª—ã:**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `utils/transform-rows-to-kanban.ts` | –£–±—Ä–∞—Ç—å `stageId` –∏–∑ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ |
| `utils/transform-data.ts` | –£–±—Ä–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥ `stage.stage_id` |
| `types/index.ts` | –£–±—Ä–∞—Ç—å `stageId` –∏–∑ —Ç–∏–ø–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫ |
| `components/KanbanCard.tsx` | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å `stage_type` –∫–∞–∫ badge –≤–º–µ—Å—Ç–æ —Å—Ç–∞–¥–∏–∏ |
| `kronospan-mock-data.ts` | –û–±–Ω–æ–≤–∏—Ç—å mock –¥–∞–Ω–Ω—ã–µ ‚Äî —É–±—Ä–∞—Ç—å `stage_id` |

**–°—Ç–∞—Ç—É—Å:** [ ] –ù–µ –Ω–∞—á–∞—Ç–æ

---

## –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```
–§–∞–∑–∞ 0: –ë–î (–¥–æ–±–∞–≤–∏—Ç—å stage_type, object_project_id)
    ‚Üì
–§–∞–∑–∞ 1: cache (—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–∞–Ω–Ω—ã—Ö)
    ‚Üì
–§–∞–∑—ã 2-4: dashboard, reports, task-transfer (–ø—Ä–æ—Å—Ç—ã–µ UI –º–æ–¥—É–ª–∏)
    ‚Üì
–§–∞–∑–∞ 5: resource-graph (—Å–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π)
    ‚Üì
–§–∞–∑—ã 6-8: budgets, project-reports, kanban
```

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã –∑–∞–ø—É—Å–∫–∞—Ç—å `npm run build` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.

---

## –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] –§–∞–∑–∞ 0: –ë–î –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ (2025-12-30)
- [x] –§–∞–∑–∞ 0: `npm run db:types` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] –§–∞–∑–∞ 1: cache –æ–±–Ω–æ–≤–ª—ë–Ω
- [ ] –§–∞–∑–∞ 2: dashboard —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–∞–∑–∞ 3: reports —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–∞–∑–∞ 4: task-transfer —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–∞–∑–∞ 5: resource-graph —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–∞–∑–∞ 6: budgets —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –§–∞–∑–∞ 7: project-reports —Ä–∞–±–æ—Ç–∞–µ—Ç (2025-12-30)
- [ ] –§–∞–∑–∞ 8: kanban —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–∏–Ω–∞–ª—å–Ω–æ: `npm run build` –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

---

## –ë—É–¥—É—â–∏–µ —à–∞–≥–∏ (–ø–æ—Å–ª–µ UI –º–∏–≥—Ä–∞—Ü–∏–∏)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ UI –º–æ–∂–Ω–æ –±—É–¥–µ—Ç:

1. **–û–±–Ω–æ–≤–∏—Ç—å modules/projects –∏ modules/planning** ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏
2. **–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç–∞–¥–∏—è–º–∏** ‚Äî —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
3. **–£–¥–∞–ª–∏—Ç—å FK object_stage_id** ‚Äî –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ object_project_id
4. **–£–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É stages** ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —à–∞–≥
5. **–£–¥–∞–ª–∏—Ç—å FK stage_id –∏–∑ project_reports** ‚Äî –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ project_id

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- **decomposition_stages** ‚Äî —ç—Ç–æ –î–†–£–ì–ê–Ø —Å—É—â–Ω–æ—Å—Ç—å (—ç—Ç–∞–ø—ã –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ä–∞–∑–¥–µ–ª–∞). –ù–µ –ø—É—Ç–∞—Ç—å —Å–æ stages –ø—Ä–æ–µ–∫—Ç–∞!
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ —É–∂–µ –∏–º–µ—é—Ç —Ç–æ–ª—å–∫–æ 1 —Å—Ç–∞–¥–∏—é ‚Äî –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –ø—Ä–æ—Å—Ç–æ–π
- –ü—Ä–æ–µ–∫—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç–∞–¥–∏—è–º–∏ (–º—É—Å–æ—Ä–Ω—ã–µ) –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
