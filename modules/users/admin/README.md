# Панель администратора

## Описание
Панель администратора предназначена для управления структурой организации: отделами, командами, должностями, категориями и ролями с разрешениями. Управление конкретными пользователями осуществляется в модуле "Пользователи".

## Структура панели

### Вкладки
1. **Отделы** - управление организационной структурой отделов
2. **Команды** - управление командами внутри отделов
3. **Должности** - управление должностями сотрудников
4. **Категории** - управление категориями задач и проектов
5. **Управление ролями** - настройка ролей и разрешений

### Архитектурные принципы
- **Разделение ответственности**: админ панель управляет структурой, модуль пользователей - конкретными пользователями
- **Единообразие**: все вкладки следуют единому паттерну интерфейса
- **Безопасность**: проверка прав доступа на уровне компонентов

## Компонент управления ролями и разрешениями

### Описание
Компонент `RolesTab` представляет собой интерактивную матрицу для управления ролями и их разрешениями в системе. Он позволяет администраторам создавать и удалять роли, а также настраивать разрешения для каждой роли через удобный визуальный интерфейс.

## Основные возможности
- Создание новых ролей с названием и описанием
- Удаление существующих ролей
- Управление разрешениями через матричный интерфейс
- Поиск ролей по названию
- Предварительный просмотр изменений до сохранения
- Массовое сохранение изменений

## Интерфейс
### Верхняя панель
- Поле поиска для фильтрации ролей
- Кнопка "Создать роль"
- Кнопка "Удалить роль"
- Кнопка сохранения изменений (активна только при наличии изменений)

### Матрица разрешений
- Строки: доступные разрешения в системе
- Столбцы: существующие роли
- Ячейки: интерактивные переключатели состояния разрешения

### Цветовая индикация
- Черный: активное разрешение
- Белый: неактивное разрешение
- Зеленый: разрешение будет добавлено
- Серый: разрешение будет удалено

## Модальные окна
1. **Создание роли**
   - Поле для названия (макс. 20 символов)
   - Поле для описания (макс. 50 символов)
   - Валидация уникальности названия

2. **Удаление роли**
   - Выбор роли из выпадающего списка
   - Подтверждение удаления

3. **Сохранение изменений**
   - Предварительный просмотр изменений
   - Подтверждение сохранения

## Технические особенности
- Оптимизированная производительность через мемоизацию
- Обработка race conditions при сохранении
- Предотвращение множественных запросов
- Обработка ошибок с информативными сообщениями
- Поддержка доступности (ARIA-атрибуты)

## Работа с данными
### Локальное состояние
- Список ролей и разрешений
- Текущие связи роль-разрешение
- Ожидающие изменения
- Состояние загрузки
- Состояние модальных окон

### Взаимодействие с базой данных
- Таблица `roles`: хранение ролей
- Таблица `permissions`: хранение разрешений
- Таблица `role_permissions`: связи между ролями и разрешениями

## Примеры использования

### Создание новой роли
1. Нажмите кнопку "Создать роль"
2. Введите название и описание
3. Подтвердите создание

### Настройка разрешений
1. Найдите нужную роль через поиск
2. Кликните по ячейкам для изменения разрешений
3. Проверьте предварительный просмотр изменений
4. Нажмите кнопку сохранения для применения

### Удаление роли
1. Нажмите кнопку "Удалить роль"
2. Выберите роль из списка
3. Подтвердите удаление

## Безопасность
- Валидация входных данных
- Проверка прав доступа
- Подтверждение критических операций
- Защита от случайных действий

## Зависимости
- React
- Supabase Client
- Tailwind CSS
- Shadcn/ui компоненты
- Lucide иконки

## Рекомендации по использованию
1. Регулярно сохраняйте изменения
2. Используйте поиск при работе с большим количеством ролей
3. Проверяйте предварительный просмотр перед сохранением
4. Внимательно проверяйте названия при создании ролей 