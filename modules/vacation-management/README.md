# Модуль управления отпусками

Модуль для управления отпусками сотрудников с возможностью просмотра, создания, редактирования и одобрения отпусков.

## Основные компоненты

- **VacationManagementStore** - Zustand стор для управления состоянием
- **VacationGanttChart** - Компонент для отображения отпусков в виде диаграммы Ганта
- **VacationFormModal** - Модальное окно для создания/редактирования отпусков

## Предотвращение состояния гонки

### Проблема
При быстром переключении между отделами возникала проблема состояния гонки (race condition), когда данные от предыдущего запроса могли перезаписать данные текущего запроса.

### Решение
Реализована система токенов запросов:

1. **Генерация токена**: При каждом изменении отдела генерируется уникальный токен
2. **Проверка актуальности**: Перед обновлением состояния проверяется, что токен запроса соответствует текущему токену
3. **Отмена устаревших запросов**: Устаревшие запросы игнорируются и не обновляют состояние

```typescript
// Пример использования
const { setSelectedDepartment } = useVacationManagementStore()

// Быстрое переключение между отделами - только последний запрос будет применен
setSelectedDepartment('dept-1')
setSelectedDepartment('dept-2') // Предыдущий запрос будет отменен
setSelectedDepartment('dept-3') // Только этот запрос обновит состояние
```

### Логирование
Система включает логирование отмененных запросов:
- `"Отменяем устаревший запрос сотрудников для отдела: {departmentId}"`
- `"Отменяем обновление состояния для устаревшего запроса сотрудников"`
- `"Отменяем устаревший запрос отпусков для сотрудников: {count}"`

## Типы

### VacationEvent
Представляет событие отпуска в календаре.

### Employee
Информация о сотруднике.

### Department
Информация об отделе.

### VacationManagementState
Состояние стора, включающее:
- `currentRequestToken` - токен для отслеживания актуальности запросов
- `selectedDepartmentId` - выбранный отдел
- `employees` - список сотрудников
- `vacations` - список отпусков
- `departments` - список отделов
- `isLoading` - состояние загрузки
- `error` - текущая ошибка

## API методы

- `setSelectedDepartment(departmentId)` - выбор отдела с автоматической загрузкой сотрудников
- `loadDepartments()` - загрузка списка отделов
- `loadEmployees(departmentId)` - загрузка сотрудников отдела
- `loadVacations(employeeIds)` - загрузка отпусков сотрудников
- `createVacation()` - создание нового отпуска
- `updateVacation()` - обновление отпуска
- `deleteVacation()` - удаление отпуска
- `approveVacation()` - одобрение отпуска
- `rejectVacation()` - отклонение отпуска 