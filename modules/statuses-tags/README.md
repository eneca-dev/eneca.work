# Модуль Статусы и теги

Модуль для управления статусами проектов и тегами в системе eneca.work.

## Структура модуля

```
modules/statuses-tags/
├── statuses/                    # Подмодуль статусов секций проектов
│   ├── components/              # Компоненты для работы со статусами
│   │   ├── StatusSelector.tsx   # Компонент выбора статуса с возможностью управления
│   │   └── StatusForm.tsx       # Форма создания/редактирования статуса
│   ├── hooks/                   # Хуки для работы со статусами
│   │   └── useSectionStatuses.ts # Хук для загрузки и управления статусами
│   └── types.ts                 # Типы для статусов секций
└── types.ts                     # Общие типы модуля
```

## Основные возможности

### Статусы секций проектов

- **Создание статусов**: Возможность создавать новые статусы для секций проектов
- **Редактирование**: Изменение названия, цвета и описания статусов
- **Удаление**: Безопасное удаление неиспользуемых статусов
- **Цветовая индикация**: Каждый статус имеет цвет для визуального различения
- **Интегрированное управление**: Управление статусами происходит прямо из выпадающего списка

### Интеграция с формой создания секций

- **Обязательное поле**: При создании секции теперь обязательно выбрать статус
- **Валидация**: Форма не позволит создать секцию без выбранного статуса
- **Удобный селектор**: Компонент StatusSelector обеспечивает удобный выбор статуса

## База данных

Модуль работает с таблицей `section_statuses`:

```sql
CREATE TABLE section_statuses (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL UNIQUE,
  color VARCHAR NOT NULL,
  description TEXT
);
```

В таблице `sections` добавлено поле:

```sql
ALTER TABLE sections 
ADD COLUMN section_status_id UUID REFERENCES section_statuses(id);
```

## Использование

### Управление статусами

1. Откройте любую форму создания секции или список проектов
2. Найдите выпадающий список выбора статуса
3. Нажмите на кнопку-шестеренку рядом со стрелкой выпадающего списка
4. Войдите в "Режим управления статусами"
5. Используйте кнопку "+" для создания новых статусов
6. Используйте кнопки редактирования и удаления рядом с каждым статусом

### Использование в проектах

При создании новой секции проекта:

1. Заполните название секции (обязательно)
2. Выберите статус из выпадающего списка (обязательно)
3. Заполните остальные поля по необходимости
4. Нажмите "Создать раздел"

## Компоненты

### StatusSelector

Переиспользуемый компонент для выбора статуса с интегрированным управлением:

```tsx
<StatusSelector
  value={statusId}
  onChange={setStatusId}
  required={true}
  placeholder="Выберите статус..."
/>
```

**Особенности:**
- Кнопка-шестеренка доступна всем пользователям
- Имеет два режима: обычный выбор и режим управления
- В режиме управления показывает кнопки редактирования и удаления для каждого статуса
- Интегрированное создание новых статусов

### StatusForm

Модальная форма для создания и редактирования статусов:

```tsx
<StatusForm
  isOpen={isOpen}
  onClose={onClose}
  status={editingStatus} // null для создания нового
  onSuccess={onSuccess}
/>
```

## Типы данных

### SectionStatus

```typescript
interface SectionStatus {
  id: string;
  name: string;
  color: string;
  description?: string;
}
```

### SectionStatusFormData

```typescript
interface SectionStatusFormData {
  name: string;
  color: string;
  description?: string;
}
```

## Интеграция

Модуль интегрирован в основное приложение через:

1. **Форма секций**: Обновлена `modules/projects/components/CreateSectionModal.tsx`
2. **Типы проектов**: Добавлено поле `section_status_id` в `modules/projects/types.ts`
3. **Дерево проектов**: Интегрировано отображение и редактирование статусов в `modules/projects/components/ProjectsTree.tsx`

## Безопасность

- При удалении статуса запрашивается подтверждение
- Если удаляется текущий выбранный статус, выбор автоматически сбрасывается
- Все изменения синхронизируются в реальном времени между компонентами

## Дальнейшее развитие

В будущем модуль можно расширить для:

- Управления тегами проектов
- Статусы для других сущностей (проекты, задачи)
- Группировка статусов по категориям
- Настройки цветовых схем и тем
- Шаблоны статусов для разных типов проектов 