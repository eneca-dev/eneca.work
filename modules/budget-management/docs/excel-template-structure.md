# Структура шаблона декомпозиции проекта

Документ описывает структуру Excel-файла **"ШАБЛОН_Декомпозиция проекта.xlsx"**, который используется для планирования проектных работ с декомпозицией задач, расчётом трудозатрат и построением календарного графика.

---

## Листы в файле

| № | Название листа | Назначение |
|---|----------------|------------|
| 1 | Инструкция | Руководство по заполнению шаблона |
| 2 | **Декомпозиция** | Основной рабочий лист (172 строки × 228 столбцов) |
| 3 | Лист1 | Вспомогательный лист |
| 4 | Список необх ИД и ЗД | Список исходных данных и заданий |
| 5 | **Ставки** | Справочник ставок по категориям специалистов |

---

## Лист "Декомпозиция"

### Шапка документа (строки 1-2)

| Индекс столбца | Название | Описание |
|----------------|----------|----------|
| 1 | Шифр проекта | Формат: "№ГУП"-Х-ХХ/ХХ-"Стадия" "Наименование объекта" |
| 6 | Стадия | Код стадии проекта |
| 7 | Раздел | Код раздела проектной документации |
| 8 | Версия | Номер версии документа |

### Основные столбцы данных (строка 6 — заголовки)

#### Идентификация задачи (столбцы 0-5)

| Индекс | Название | Тип данных | Описание | Пример |
|--------|----------|------------|----------|--------|
| 0 | Составной ключ | string | Автогенерируемый идентификатор | `[Курирование] 1.1.АР_Курирование` |
| 1 | **РАЗДЕЛ** | string | Код раздела проектной документации | `АР`, `КР`, `ВК`, `ЭС`, `ОВ` |
| 2 | **СТАДИЯ** | string | Буквенный код стадии | `А`, `Б`, `В` |
| 3 | **ПОЗИЦИЯ ПО ГЕНПЛАНУ** | string | Позиция здания/объекта на генплане | `[Курирование]`, `[ОТР]`, `[поз. по ГП]` |
| 4 | **ЭТАПЫ** | string | Уникальный код этапа | `1.1.АР_Курирование`, `1.2.АР_ОТР` |
| 5 | **BACKLOG ПРОЕКТА** | string | Текстовое описание задачи | `Курирование по проекту, совещания` |

#### Трудозатраты по категориям (столбцы 6-9)

| Индекс | Название | Тип данных | Единица измерения | Описание |
|--------|----------|------------|-------------------|----------|
| 6 | **К** | number | чел-час | Трудозатраты категории К (Конструктор) |
| 7 | **ВС** | number | чел-час | Трудозатраты категории ВС (Ведущий Специалист) |
| 8 | **ГС** | number | чел-час | Трудозатраты категории ГС (Главный Специалист) |
| 9 | **ВСЕГО** | number | чел-час | Сумма трудозатрат всех категорий |

#### Расчётные показатели (столбцы 11-22)

| Индекс | Название | Тип данных | Единица | Описание |
|--------|----------|------------|---------|----------|
| 11 | % по разделу | number | % | Доля задачи от общего объёма раздела |
| 12 | % по задачам | number | % | Доля от общего числа задач |
| 13 | Приведенные трудозатраты | number | чел-ч | Трудозатраты, приведённые к средней ставке |
| 14 | Средняя ставка отдела | number | BYN/чел-ч | Средняя почасовая ставка отдела |
| 15 | Запрашиваемый бюджет | number | BYN | Рассчитанный бюджет на задачу |
| 16 | Средняя ставка по задаче | number | BYN/чел-ч | Средневзвешенная ставка по задаче |
| 17 | Максимальный бюджет по разделу | number | BYN | Верхняя граница бюджета |
| 18 | Трудозатраты плановые | number | чел-ч | Плановые трудозатраты |
| 20 | СТп | number | BYN | Ставка плановая |
| 21 | Бп | number | BYN | Бюджет плановый |
| 22 | Тп | number | чел-ч | Трудозатраты плановые |

#### Планирование ресурсов (столбцы 23-26)

| Индекс | Название | Тип данных | Единица | Описание |
|--------|----------|------------|---------|----------|
| 23 | Количество специалистов | number | чел | Планируемое количество специалистов на задаче |
| 24 | Дата старта этапа | date | - | Дата начала работ по этапу |
| 25 | Длительность этапа | number | раб. дней | Продолжительность этапа в рабочих днях |
| 26 | Дата финиша этапа | date | - | Дата окончания работ по этапу |

#### Календарный график (столбцы 28-227)

Диаграмма Ганта, охватывающая **200 рабочих дней** (~10 месяцев).

| Диапазон столбцов | Период | Описание |
|-------------------|--------|----------|
| 28-47 | 1-20 раб. дней | Первые 4 недели от старта |
| 48-67 | 21-40 раб. дней | 5-8 недели |
| 68-87 | 41-60 раб. дней | 9-12 недели |
| 88-107 | 61-80 раб. дней | 13-16 недели |
| 108-127 | 81-100 раб. дней | 17-20 недели |
| 128-147 | 101-120 раб. дней | 21-24 недели |
| 148-167 | 121-140 раб. дней | 25-28 недели |
| 168-187 | 141-160 раб. дней | 29-32 недели |
| 188-207 | 161-180 раб. дней | 33-36 недели |
| 208-227 | 181-200 раб. дней | 37-40 недели |

**Значения ячеек:**
- **`-`** — этап активен в этот день (выполняется работа)
- **`0`** — этап не выполняется в этот день

---

## Лист "Ставки"

Справочник коэффициентов для расчёта стоимости работ по категориям специалистов.

| Индекс | Название | Тип данных | Описание |
|--------|----------|------------|----------|
| 0 | Отдел | string | Код отдела (АРгражд, КРгражд, ВКгражд, ЭСгражд, ОВгражд, ТСБС) |
| 1 | СТср | number | Средняя ставка отдела (BYN/чел-ч) |
| 2 | К | number | Коэффициент для категории К |
| 3 | ВС | number | Коэффициент для категории ВС |
| 4 | ГС | number | Коэффициент для категории ГС |

### Пример данных листа "Ставки"

| Отдел | СТср | К | ВС | ГС |
|-------|------|---|----|----|
| АРгражд | 16.59 | 1.26 | 1.74 | 1.95 |
| КРгражд | 17.47 | 1.11 | 1.51 | 1.81 |
| ВКгражд | 16.99 | 1.09 | 1.19 | 1.65 |
| ЭСгражд | 18.68 | 0.87 | 1.22 | 1.44 |
| ОВгражд | 17.42 | 0.94 | 1.35 | 1.64 |
| ТСБС | 14.29 | 1.00 | 1.06 | 1.57 |

---

## Категории специалистов

| Код | Полное название | Описание |
|-----|-----------------|----------|
| **К** | Конструктор | Базовая категория специалиста |
| **ВС** | Ведущий специалист | Специалист среднего уровня |
| **ГС** | Главный специалист | Специалист высшего уровня |

---

## Разделы проектной документации

| Код | Название раздела |
|-----|------------------|
| АР | Архитектурные решения |
| КР | Конструктивные решения |
| ВК | Водоснабжение и канализация |
| ЭС | Электроснабжение |
| ОВ | Отопление и вентиляция |
| ТСБС | Технические системы безопасности и связи |

---

## Иерархия данных

```
Проект (шифр + наименование)
└── Стадия (А, Б, В...)
    └── Раздел (АР, КР, ВК...)
        └── Позиция по генплану
            └── Этап (1.1.АР_Курирование, 1.2.АР_ОТР...)
                └── Задача (описание в backlog)
                    ├── Трудозатраты (К, ВС, ГС)
                    ├── Бюджет (BYN)
                    └── Сроки (старт, длительность, финиш)
```

---

## Формулы и расчёты

### Расчёт бюджета задачи

```
Бюджет = (К × Ставка_К) + (ВС × Ставка_ВС) + (ГС × Ставка_ГС)
```

Где:
- `Ставка_категории = СТср × Коэффициент_категории`

### Расчёт длительности этапа

```
Длительность (раб. дней) = Трудозатраты_плановые / (Количество_специалистов × 8)
```

---

## Соответствие структуре базы данных eneca.work

| Excel столбец | Таблица БД | Поле | Примечание |
|---------------|------------|------|------------|
| РАЗДЕЛ | sections | section_code | Код раздела |
| СТАДИЯ | stages | stage_code | Код стадии |
| ЭТАПЫ | decomposition_stages | name | Название этапа декомпозиции |
| BACKLOG ПРОЕКТА | decomposition_stages | description | Описание задачи |
| К, ВС, ГС | loadings | planned_hours | Трудозатраты по категориям |
| Дата старта | loadings | start_date | Начало загрузки |
| Дата финиша | loadings | end_date | Окончание загрузки |
| Количество специалистов | loadings | rate | Ставка загрузки (0-1) |

---

## Примечания

1. **Валюта:** Все денежные значения в BYN (белорусских рублях)
2. **Рабочий день:** 8 часов
3. **Календарь:** Учитываются только рабочие дни (пн-пт), без праздников
4. **Версионирование:** Документ поддерживает версионирование через поле "Версия"
